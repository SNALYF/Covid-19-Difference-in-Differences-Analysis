# Empirical Project 114 - COVID-19 Policy Analysis Pipeline

This project implements a Difference-in-Differences (DiD) analysis to evaluate the impact of different COVID-19 policy responses (Mandatory vs. Optional vs. No Control) on infection and death rates across multiple countries.

The codebase has been refactored from monolithic scripts into a modular, reproducible R pipeline.

## Project Structure

The project is organized into a standard R project structure for clarity and reproducibility:

-   **`data/`**: Contains all data files.
    -   `clean_data.rds`: The processed dataset used for analysis (generated by the pipeline).
    -   `WHO-COVID-19-global-data_selected.csv`: Raw input data.
-   **`R/`**: Contains utility functions.
    -   `utils.R`: Helper functions for plotting and data manipulation.
-   **`scripts/`**: Sequential analysis scripts.
    -   `01_load_clean.R`: Loads raw data, cleans it, and creates derived variables (e.g., policy groups).
    -   `02_descriptive_analysis.R`: Generates time-series and policy impact plots. **Robust Feature**: Automatically falls back to high-fidelity Base R plotting if `ggplot2` is unavailable.
    -   `03_regression_analysis.R`: Executes DiD regressions and exports results as both text and images.
    -   `archive/`: Contains the original, legacy R scripts.
-   **`output/`**: All pipeline outputs.
    -   `img/`: Beautified charts and plots (e.g., `policy_impact_cases.png`).
    -   `regression/`: Regression tables in `.txt` and `.png` formats.
-   **`docs/`**: Documentation and original assets.
-   **`main.R`**: The master execution script that runs the entire pipeline from start to finish.

## How to Run

You can run the entire analysis pipeline with a single command. The script handles data loading, visualization, and regression analysis automatically.

### Option 1: Using RStudio
1.  Open the project folder in RStudio.
2.  Open `main.R`.
3.  Click the **Source** button (or press `Ctrl + Shift + Enter`).

### Option 2: Using Terminal
Run the following command in your terminal:
```bash
Rscript main.R
```

## Robustness & Troubleshooting

-   **Package Installation**: `main.R` will automatically attempt to install missing packages (`dplyr`, `stargazer`, etc.).
-   **Plotting Engine**: The pipeline includes a robust plotting engine. If `ggplot2` fails due to local environment issues (e.g., missing system fonts), the scripts will automatically switch to **Enhanced Base R Plotting**. This ensures you always get high-quality, high-fidelity charts with confidence intervals, regardless of your setup.

## Outputs

After running the pipeline, check the `output/` directory:
-   **Visualizations**: Go to `output/img/` for trend lines and policy impact graphs.
-   **Tables**: Go to `output/regression/` for regression results (available as copy-pasteable text and ready-to-use PNG images).
